/**
 * Content Collection Schema
 * Version: Draft
 */
{
  "title": "Search",
  "description": "",
  "callToAction": {
    "text": "View all",
    "url": "/search"
  },
  /**
   * "Internal" contains the rules for generating the search query.
   * These rules are set by default and, with the exception of
   * sort and itemsToLoad, are unable to be changed via an exposed user form.
   */
  "internal": {
    /**
     * -------------------------------------------------------------------------
     * Simple - These properties are converted into an Elasticsearch DSL query.
     * -------------------------------------------------------------------------
     */
    // For displaying user defined content - @todo are they uuid or nids?
    "contentIds": [],
    // For displaying content by type
    "contentTypes": ["profile"],
    // For displaying content by various field values
    "contentFields": {
      "field_topic": { "operator": "AND", "values": [1] },
      "field_tags": { "operator": "AND", "values": [5] }
    },
    // When used like a "Related articles" list, we may want to exclude current page.
    "includeCurrentPage": false,
    "excludeIds": [], // what about fields / types etc?
    // For displaying content by date
    "dateFilter": {
      // Things to support: Year ranges, next 2 weeks, new thing this week, whats new
      "criteria": "range", // "range" / "all" / "upcoming" / "from_current" / "past"
      "startDateField": "field_profile_womens_inducted_date",
      "endDateField": "field_profile_womens_inducted_date",
      "dateRangeStart": "2021-01-01T11:28:23+10:00",
      "dateRangeEnd": "2022-01-01T11:28:23+10:00"
    },
    // Sort - will be overridden by the first option in `interface.display.sort` if available.
    "sort": { "name": "Title A-Z", "value": [ { "field": "title", "direction": "asc" } ] },
    // itemsToLoad - will be overridden by the first option in `interface.display.pagination` if available.
    "itemsToLoad": 10,
    /**
     * -------------------------------------------------------------------------
     * Complex - Pure Elasticsearch DSL Query
     * -------------------------------------------------------------------------
     */
    // POST to /search-api - Build functionality in search-api to accept POSTs
    "custom": {
      "bool": {
        "must": {
          "match_all": {}
        },
        "filter": [
          {
            "range": { "field_event_date_end_value": { "gte": "2020-01-30T13:00:00.000Z" } }
          },
          {
            "terms": { "type": ["event"] }
          },
          {
            "terms": { "field_node_site": ["4"] }
          }
        ]
      }
    }
  },
  /**
   * "Interface" contains rules for displaying the results, and displaying
   * the exposed user form for changing the search query.
   * Where "type" is used, nuxt-tide will allow for defining custom
   * functions to extend the existing functionality.
   */
  "interface": {
    // Keyword filter
    "keyword": {
      // https://www.elastic.co/guide/en/elasticsearch/reference/7.8/query-dsl-simple-query-string-query.html
      "type": "basic", // "basic" = use phrase match, "custom-xyz" = a custom implementation (e.g. legislation)
      "label": "Search by keyword",
      "placeholder": "Enter keyword(s)",
      "fields": [ "title", "body", "summary_processed" ]
    },
    // Advanced filters
    "filters": {
      "displayHidden": false, // show or hide advanced fields
      "submitOnChange": false,
      "label": "Refine search",
      "submit": {
        "visible": true,
        "label": "Apply change"
      },
      "clearForm": {
        "visible": true, // or "on-dirty"
        "label": "Clear search filters"
      },
      "defaultStyling": true, // Default: 1 field = 100%, 2 fields = 50%, 3 = 33.33% (desktop)
      "fields": [
        {
          "type": "custom-date" // Example custom implementation. Uses a custom hook to populate.
        },
        {
          "type": "basic",
          "component": "rpl-select",
          "options": {
            // Ability to set vue-form-generator field settings directly.
            // If select and no existing values are set, assume aggregation
          },
          "additionalClasses": [ "rpl-col-2" ],
          "elasticsearch-field": "field_year",
          "elasticsearch-aggregation": true, // this will populate the component options
        }
      ]
    },
    // Display of results
    "display": {
      "type": "grid", // extensible -> allow for more
      "options": {
        // Options passed to the display component
        "resultsCountText": "Displaying {range} of {count} results",
        "loadingText": "Loading",
        "noResultsText": "Sorry! We couldn't find any matches",
        "errorText": "Search isn't working right now, please try again later.",
        "sort": {
          "userExposedOptions": [
            { "name": "Relevance", "value": null },
            { "name": "Title A-Z", "value": [ { "field": "title", "direction": "asc" } ] },
            { "name": "Title Z-A", "value": [ { "field": "title", "direction": "desc" } ] },
            { "name": "Newest", "value": [ { "field": "field_date", "direction": "asc" } ] },
            { "name": "Oldest", "value": [ { "field": "field_date", "direction": "desc" } ] }
          ]
        },
        "pagination": {
          "type": "list", // Future examples: "load-more" / "infinite-scroll"
          "userExposedOptions": [
            { "name": "10", "value": 10 },
            { "name": "20", "value": 20 },
            { "name": "50", "value": 50 },
            { "name": "All", "value": 9999 }
          ]
        }
      },
      "resultComponent": {
        // Object passed to a custom "hook" to implement mapping.
        "type": "basic-card"
      }
    }
  }
}
